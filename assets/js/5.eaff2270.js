(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{135:function(t,e,s){"use strict";s.r(e);var a=s(0),n=Object(a.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_3-6-git-rebase"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-git-rebase","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.6 git rebase")]),t._v(" "),a("p",[t._v("🙅"),a("strong",[t._v("永远不要对已提交到远程的commit使用")])]),t._v(" "),a("div",{staticClass:"danger custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("guideline: "),a("strong",[t._v("Do not rebase commits that exist outside your repository.")]),a("br"),t._v("\n作者神吐槽：If you follow that guideline, you’ll be fine. If you don’t, people will hate you, and you’ll be scorned by friends and family.")])]),t._v(" "),a("p",[t._v("rebase的原理：找到两个要整合的分支(当前分支和要整合到的分支)的共同祖先，然后取得当前分支每次提交引入的diff，并将diff保存成临时文件，将当前分支重置为要整合到的分支，最后在该分支上一次引入之前保存的每个更改")]),t._v(" "),a("p",[t._v("rebase的commit和之前的commit只是内容相同，commit id为证")]),t._v(" "),a("p",[t._v("如果只有一个分支有改动，是不能使用rebase的，直接fast forward merge即可(因为都没有分叉啊，笨蛋)")]),t._v(" "),a("h2",{attrs:{id:"基本的rebase"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本的rebase","aria-hidden":"true"}},[t._v("#")]),t._v(" 基本的rebase")]),t._v(" "),a("p",[t._v("C4和C4'是不同的commit（commit id变了），只是内容相同")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 切换到experiment分支，再以master为基，将该分支的更改重现到master分支上，如下两张图")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# = git checkout experiment + git rebase master")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" rebase master experiment\n")])])]),a("p",[t._v("初始仓库\n"),a("img",{attrs:{src:s(88),alt:"初始"}}),t._v("\n执行git rebase master experiment\n"),a("img",{attrs:{src:s(89),alt:""}})]),t._v(" "),a("h3",{attrs:{id:"bash实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bash实例","aria-hidden":"true"}},[t._v("#")]),t._v(" bash实例")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 说明")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1.web-dev为基础分支，web-dev-1为要被合并的分支，两个分支都只比公共祖先分支ahead一个commit")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2.co = checkout")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3.lg = log --color --graph --pretty=format:'%C(yellow)%h%Creset -%Cred%d%Creset %s  %C(bold blue)(%cn %cr)%Creset'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看web-dev，f4b40956为最新commit")]),t._v("\nguidetheorient@URCUMQA MINGW64 /c/d/test/learn-git-2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("web-dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" lg -2\n* f4b40956 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HEAD -"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" web-dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" a-test1 \n* dee7308d - fix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$views")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" bugfix\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看web-dev-1分支commit信息")]),t._v("\nguidetheorient@URCUMQA MINGW64 /c/d/test/learn-git-2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("web-dev-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" co web-dev-1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" lg -2\n* 4db35349 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HEAD -"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" web-dev-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b-test1\n* dee7308d - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("web-dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" fix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$views")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" bugfix \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行rebase")]),t._v("\nguidetheorient@URCUMQA MINGW64 /c/d/test/learn-git-2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("web-dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" rebase web-dev web-dev-1\nFirst, rewinding "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("head")]),t._v(" to replay your work on "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("top")]),t._v(" of it"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nApplying: "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意：执行完后分支自动切换到web-dev-1，所以rebase实际是针对被合并分支进行")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 并且此时web-dev-1 b-test1的commit id已经发生变化cc2361f6（现在） ！== 4db35349（原来）")]),t._v("\nguidetheorient@URCUMQA MINGW64 /c/d/test/learn-git-2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("web-dev-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" lg -2\n* cc2361f6 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HEAD -"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" web-dev-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b-test1\n* f4b40956 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("web-dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" a-test1\n* dee7308d - *1187 fix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$views")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" bugfix \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看web-dev分支，发现没有变化")]),t._v("\nguidetheorient@URCUMQA MINGW64 /c/d/test/learn-git-2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("web-dev-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" co web-dev "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" lg -2\nSwitched to branch "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'web-dev'")]),t._v("\n* f4b40956 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HEAD -"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" web-dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" a-test1\n* dee7308d - *1187 fix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$views")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" bugfix\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 此时web-dev和web-dev-1其实就是一条线上的两个分支，可以执行快速合并")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这个其实针对于要将内容合到主分支的人需要操作的（仓库管理者），一般直接rebase到远程分支，再push就可以了")]),t._v("\nguidetheorient@URCUMQA MINGW64 /c/d/test/learn-git-2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("web-dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" merge web-dev-1\nUpdating f4b40956"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("cc2361f6\nFast-forward\n test.md                                                 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   1 +\n 1 files changed, 1 insertions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n create mode 100644 test.md\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 至此web-dev合并了web-dev-1的内容，并且保持了commit树是一条直线")]),t._v("\nguidetheorient@URCUMQA MINGW64 /c/d/test/learn-git-2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("web-dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" lg -3\n* cc2361f6 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HEAD -"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" web-dev, web-dev-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b-test1\n* f4b40956 - web-dev a-test1\n* dee7308d - *1187 fix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$views")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" bugfix \n")])])]),a("h2",{attrs:{id:"more-interesting-rebases"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#more-interesting-rebases","aria-hidden":"true"}},[t._v("#")]),t._v(" More Interesting Rebases")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 说人话，以master为基，将client分支相对于server分支独有的commit，patch到master上面")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" rebase --onto master server client\n")])])]),a("p",[a("img",{attrs:{src:s(90),alt:""}}),t._v(" "),a("img",{attrs:{src:s(91),alt:""}})]),t._v(" "),a("h2",{attrs:{id:"the-perils-of-rebasing"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-perils-of-rebasing","aria-hidden":"true"}},[t._v("#")]),t._v(" The Perils of Rebasing")]),t._v(" "),a("p",[t._v("目前公司是如下的操作，一般update后进行rebase可以避免迷之"),a("code",[t._v("push -f")]),t._v("，至于perils等遇到的时候再google")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" remote update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" rebase remote/teamone\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 直接push到远程对应分支，就需要在本地执行fast forward merge了")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push origin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("branch name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("h2",{attrs:{id:"rebase-vs-merge"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rebase-vs-merge","aria-hidden":"true"}},[t._v("#")]),t._v(" Rebase vs. Merge")]),t._v(" "),a("p",[t._v("follow you heart，取决于你想要怎样的提交历史，只是记住不要对提交到远程的commit执行rebase就好")])])},[],!1,null,null,null);e.default=n.exports},88:function(t,e,s){t.exports=s.p+"assets/img/2018-10-12-11-08-11.9e50bf12.png"},89:function(t,e,s){t.exports=s.p+"assets/img/2018-10-12-11-08-17.57d49ae9.png"},90:function(t,e,s){t.exports=s.p+"assets/img/2018-10-12-11-53-55.44628361.png"},91:function(t,e,s){t.exports=s.p+"assets/img/2018-10-12-11-57-03.4c0c3a0a.png"}}]);